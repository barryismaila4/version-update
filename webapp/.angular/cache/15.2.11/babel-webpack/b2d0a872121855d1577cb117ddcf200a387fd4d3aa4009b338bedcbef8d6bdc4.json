{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/notification.service\";\nimport * as i2 from \"../../services/plant.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction NotificationsComponent_div_5_option_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 15);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const plant_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", plant_r3.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(plant_r3.name);\n  }\n}\nfunction NotificationsComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"h3\");\n    i0.ɵɵtext(2, \"Nouvelle notification\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"form\", 6);\n    i0.ɵɵlistener(\"ngSubmit\", function NotificationsComponent_div_5_Template_form_ngSubmit_3_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.createNotification());\n    });\n    i0.ɵɵelementStart(4, \"input\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function NotificationsComponent_div_5_Template_input_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.newNotification.title = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"textarea\", 8);\n    i0.ɵɵlistener(\"ngModelChange\", function NotificationsComponent_div_5_Template_textarea_ngModelChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.newNotification.description = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"input\", 9);\n    i0.ɵɵlistener(\"ngModelChange\", function NotificationsComponent_div_5_Template_input_ngModelChange_6_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.newNotification.notificationDate = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"select\", 10);\n    i0.ɵɵlistener(\"ngModelChange\", function NotificationsComponent_div_5_Template_select_ngModelChange_7_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.selectedPlantId = $event);\n    });\n    i0.ɵɵelementStart(8, \"option\", 11);\n    i0.ɵɵtext(9, \"Aucune plante\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(10, NotificationsComponent_div_5_option_10_Template, 2, 2, \"option\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 13);\n    i0.ɵɵtext(12, \"Cr\\u00E9er\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function NotificationsComponent_div_5_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.cancelForm());\n    });\n    i0.ɵɵtext(14, \"Annuler\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.newNotification.title);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.newNotification.description);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.newNotification.notificationDate);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.selectedPlantId);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.plants);\n  }\n}\nfunction NotificationsComponent_div_7_button_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 1);\n    i0.ɵɵlistener(\"click\", function NotificationsComponent_div_7_button_9_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const notification_r11 = i0.ɵɵnextContext().$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.markAsRead(notification_r11.id));\n    });\n    i0.ɵɵtext(1, \"Marquer comme lu\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction NotificationsComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"h4\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"small\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 17);\n    i0.ɵɵtemplate(9, NotificationsComponent_div_7_button_9_Template, 2, 0, \"button\", 18);\n    i0.ɵɵelementStart(10, \"button\", 1);\n    i0.ɵɵlistener(\"click\", function NotificationsComponent_div_7_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r17);\n      const notification_r11 = restoredCtx.$implicit;\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.deleteNotification(notification_r11.id));\n    });\n    i0.ɵɵtext(11, \"Supprimer\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const notification_r11 = ctx.$implicit;\n    i0.ɵɵclassProp(\"unread\", !notification_r11.isRead);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(notification_r11.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(notification_r11.description);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Date: \", i0.ɵɵpipeBind2(7, 6, notification_r11.notificationDate, \"medium\"), \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", !notification_r11.isRead);\n  }\n}\nexport class NotificationsComponent {\n  constructor(notificationService, plantService, route) {\n    this.notificationService = notificationService;\n    this.plantService = plantService;\n    this.route = route;\n    this.notifications = [];\n    this.plants = [];\n    this.showForm = false;\n    this.newNotification = {\n      id: 0,\n      title: '',\n      description: '',\n      notificationDate: new Date().toISOString(),\n      isRead: false,\n      user: undefined,\n      plant: undefined\n    };\n    this.selectedPlantId = 0;\n  }\n  ngOnInit() {\n    this.loadNotifications();\n    this.loadPlants();\n    // Récupère l'ID de plante depuis l'URL si présent\n    this.route.queryParams.subscribe(params => {\n      if (params['plantId']) {\n        this.selectedPlantId = +params['plantId'];\n      }\n    });\n  }\n  loadNotifications() {\n    this.notificationService.getUserNotifications().subscribe(notifications => {\n      this.notifications = notifications;\n    });\n  }\n  loadPlants() {\n    this.plantService.getUserPlants().subscribe(plants => {\n      this.plants = plants;\n    });\n  }\n  showAddForm() {\n    this.showForm = true;\n    this.newNotification = {\n      id: 0,\n      title: '',\n      description: '',\n      notificationDate: new Date().toISOString(),\n      isRead: false,\n      user: undefined,\n      plant: undefined\n    };\n  }\n  createNotification() {\n    const notificationData = {\n      title: this.newNotification.title,\n      description: this.newNotification.description,\n      notificationDate: this.newNotification.notificationDate,\n      notificationType: 'RAPPEL'\n    };\n    const plantId = this.selectedPlantId === 0 ? undefined : this.selectedPlantId;\n    this.notificationService.createNotification(notificationData, plantId).subscribe({\n      next: () => {\n        this.loadNotifications();\n        this.cancelForm();\n      },\n      error: error => {\n        console.error('Erreur création notification:', error);\n        alert('Erreur: ' + (error.error?.message || 'Création échouée'));\n      }\n    });\n  }\n  markAsRead(id) {\n    this.notificationService.markAsRead(id).subscribe(() => {\n      this.loadNotifications();\n    });\n  }\n  deleteNotification(id) {\n    if (confirm('Supprimer cette notification?')) {\n      this.notificationService.deleteNotification(id).subscribe(() => {\n        this.loadNotifications();\n      });\n    }\n  }\n  cancelForm() {\n    this.showForm = false;\n    this.selectedPlantId = 0;\n  }\n  static {\n    this.ɵfac = function NotificationsComponent_Factory(t) {\n      return new (t || NotificationsComponent)(i0.ɵɵdirectiveInject(i1.NotificationService), i0.ɵɵdirectiveInject(i2.PlantService), i0.ɵɵdirectiveInject(i3.ActivatedRoute));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: NotificationsComponent,\n      selectors: [[\"app-notifications\"]],\n      decls: 8,\n      vars: 2,\n      consts: [[1, \"notifications-container\"], [3, \"click\"], [\"class\", \"notification-form\", 4, \"ngIf\"], [1, \"notifications-list\"], [\"class\", \"notification-item\", 3, \"unread\", 4, \"ngFor\", \"ngForOf\"], [1, \"notification-form\"], [3, \"ngSubmit\"], [\"name\", \"title\", \"placeholder\", \"Titre\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"description\", \"placeholder\", \"Description\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"datetime-local\", \"name\", \"notificationDate\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"selectedPlantId\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"0\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\"], [\"type\", \"button\", 3, \"click\"], [3, \"value\"], [1, \"notification-item\"], [1, \"actions\"], [3, \"click\", 4, \"ngIf\"]],\n      template: function NotificationsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n          i0.ɵɵtext(2, \"Mes Notifications\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"button\", 1);\n          i0.ɵɵlistener(\"click\", function NotificationsComponent_Template_button_click_3_listener() {\n            return ctx.showAddForm();\n          });\n          i0.ɵɵtext(4, \"Cr\\u00E9er une notification\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(5, NotificationsComponent_div_5_Template, 15, 5, \"div\", 2);\n          i0.ɵɵelementStart(6, \"div\", 3);\n          i0.ɵɵtemplate(7, NotificationsComponent_div_7_Template, 12, 9, \"div\", 4);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.showForm);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.notifications);\n        }\n      },\n      dependencies: [i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i5.NgModel, i5.NgForm, i4.DatePipe],\n      styles: [\".notifications-container[_ngcontent-%COMP%] {\\r\\n  max-width: 1200px;\\r\\n  margin: 0 auto;\\r\\n  padding: 2rem;\\r\\n}\\r\\n\\r\\n.notifications-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\r\\n  color: #2d5016;\\r\\n  margin-bottom: 2rem;\\r\\n}\\r\\n\\r\\n.notifications-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\r\\n  background-color: #4CAF50;\\r\\n  color: white;\\r\\n  border: none;\\r\\n  padding: 10px 20px;\\r\\n  border-radius: 4px;\\r\\n  cursor: pointer;\\r\\n  margin-bottom: 2rem;\\r\\n}\\r\\n\\r\\n.notification-form[_ngcontent-%COMP%] {\\r\\n  background: white;\\r\\n  padding: 2rem;\\r\\n  border-radius: 8px;\\r\\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\\r\\n  margin-bottom: 2rem;\\r\\n}\\r\\n\\r\\n.notification-form[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\\r\\n  margin-bottom: 1rem;\\r\\n  color: #2d5016;\\r\\n}\\r\\n\\r\\n.notification-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .notification-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .notification-form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%] {\\r\\n  width: 100%;\\r\\n  padding: 8px;\\r\\n  margin-bottom: 1rem;\\r\\n  border: 1px solid #ddd;\\r\\n  border-radius: 4px;\\r\\n}\\r\\n\\r\\n.notification-form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%] {\\r\\n  height: 100px;\\r\\n  resize: vertical;\\r\\n}\\r\\n\\r\\n.notification-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\r\\n  margin-right: 1rem;\\r\\n}\\r\\n\\r\\n.notifications-list[_ngcontent-%COMP%] {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  gap: 1rem;\\r\\n}\\r\\n\\r\\n.notification-item[_ngcontent-%COMP%] {\\r\\n  background: white;\\r\\n  padding: 1.5rem;\\r\\n  border-radius: 8px;\\r\\n  box-shadow: 0 2px 10px rgba(0,0,0,0.1);\\r\\n  border-left: 4px solid #4CAF50;\\r\\n}\\r\\n\\r\\n.notification-item.unread[_ngcontent-%COMP%] {\\r\\n  border-left-color: #ff6b6b;\\r\\n  background-color: #fff9f9;\\r\\n}\\r\\n\\r\\n.notification-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%] {\\r\\n  color: #2d5016;\\r\\n  margin-bottom: 0.5rem;\\r\\n}\\r\\n\\r\\n.notification-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\\r\\n  margin-bottom: 0.5rem;\\r\\n  color: #666;\\r\\n}\\r\\n\\r\\n.notification-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%] {\\r\\n  color: #999;\\r\\n}\\r\\n\\r\\n.actions[_ngcontent-%COMP%] {\\r\\n  margin-top: 1rem;\\r\\n  display: flex;\\r\\n  gap: 0.5rem;\\r\\n}\\r\\n\\r\\n.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\r\\n  padding: 5px 10px;\\r\\n  font-size: 0.8rem;\\r\\n  margin: 0;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9ub3RpZmljYXRpb25zL25vdGlmaWNhdGlvbnMuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGlCQUFpQjtFQUNqQixjQUFjO0VBQ2QsYUFBYTtBQUNmOztBQUVBO0VBQ0UsY0FBYztFQUNkLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixZQUFZO0VBQ1osWUFBWTtFQUNaLGtCQUFrQjtFQUNsQixrQkFBa0I7RUFDbEIsZUFBZTtFQUNmLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGlCQUFpQjtFQUNqQixhQUFhO0VBQ2Isa0JBQWtCO0VBQ2xCLHNDQUFzQztFQUN0QyxtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxtQkFBbUI7RUFDbkIsY0FBYztBQUNoQjs7QUFFQTs7O0VBR0UsV0FBVztFQUNYLFlBQVk7RUFDWixtQkFBbUI7RUFDbkIsc0JBQXNCO0VBQ3RCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGFBQWE7RUFDYixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxhQUFhO0VBQ2Isc0JBQXNCO0VBQ3RCLFNBQVM7QUFDWDs7QUFFQTtFQUNFLGlCQUFpQjtFQUNqQixlQUFlO0VBQ2Ysa0JBQWtCO0VBQ2xCLHNDQUFzQztFQUN0Qyw4QkFBOEI7QUFDaEM7O0FBRUE7RUFDRSwwQkFBMEI7RUFDMUIseUJBQXlCO0FBQzNCOztBQUVBO0VBQ0UsY0FBYztFQUNkLHFCQUFxQjtBQUN2Qjs7QUFFQTtFQUNFLHFCQUFxQjtFQUNyQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxXQUFXO0FBQ2I7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsYUFBYTtFQUNiLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGlCQUFpQjtFQUNqQixpQkFBaUI7RUFDakIsU0FBUztBQUNYIiwic291cmNlc0NvbnRlbnQiOlsiLm5vdGlmaWNhdGlvbnMtY29udGFpbmVyIHtcclxuICBtYXgtd2lkdGg6IDEyMDBweDtcclxuICBtYXJnaW46IDAgYXV0bztcclxuICBwYWRkaW5nOiAycmVtO1xyXG59XHJcblxyXG4ubm90aWZpY2F0aW9ucy1jb250YWluZXIgaDIge1xyXG4gIGNvbG9yOiAjMmQ1MDE2O1xyXG4gIG1hcmdpbi1ib3R0b206IDJyZW07XHJcbn1cclxuXHJcbi5ub3RpZmljYXRpb25zLWNvbnRhaW5lciBidXR0b24ge1xyXG4gIGJhY2tncm91bmQtY29sb3I6ICM0Q0FGNTA7XHJcbiAgY29sb3I6IHdoaXRlO1xyXG4gIGJvcmRlcjogbm9uZTtcclxuICBwYWRkaW5nOiAxMHB4IDIwcHg7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gIGN1cnNvcjogcG9pbnRlcjtcclxuICBtYXJnaW4tYm90dG9tOiAycmVtO1xyXG59XHJcblxyXG4ubm90aWZpY2F0aW9uLWZvcm0ge1xyXG4gIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gIHBhZGRpbmc6IDJyZW07XHJcbiAgYm9yZGVyLXJhZGl1czogOHB4O1xyXG4gIGJveC1zaGFkb3c6IDAgMnB4IDEwcHggcmdiYSgwLDAsMCwwLjEpO1xyXG4gIG1hcmdpbi1ib3R0b206IDJyZW07XHJcbn1cclxuXHJcbi5ub3RpZmljYXRpb24tZm9ybSBoMyB7XHJcbiAgbWFyZ2luLWJvdHRvbTogMXJlbTtcclxuICBjb2xvcjogIzJkNTAxNjtcclxufVxyXG5cclxuLm5vdGlmaWNhdGlvbi1mb3JtIGlucHV0LFxyXG4ubm90aWZpY2F0aW9uLWZvcm0gdGV4dGFyZWEsXHJcbi5ub3RpZmljYXRpb24tZm9ybSBzZWxlY3Qge1xyXG4gIHdpZHRoOiAxMDAlO1xyXG4gIHBhZGRpbmc6IDhweDtcclxuICBtYXJnaW4tYm90dG9tOiAxcmVtO1xyXG4gIGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG59XHJcblxyXG4ubm90aWZpY2F0aW9uLWZvcm0gdGV4dGFyZWEge1xyXG4gIGhlaWdodDogMTAwcHg7XHJcbiAgcmVzaXplOiB2ZXJ0aWNhbDtcclxufVxyXG5cclxuLm5vdGlmaWNhdGlvbi1mb3JtIGJ1dHRvbiB7XHJcbiAgbWFyZ2luLXJpZ2h0OiAxcmVtO1xyXG59XHJcblxyXG4ubm90aWZpY2F0aW9ucy1saXN0IHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgZ2FwOiAxcmVtO1xyXG59XHJcblxyXG4ubm90aWZpY2F0aW9uLWl0ZW0ge1xyXG4gIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gIHBhZGRpbmc6IDEuNXJlbTtcclxuICBib3JkZXItcmFkaXVzOiA4cHg7XHJcbiAgYm94LXNoYWRvdzogMCAycHggMTBweCByZ2JhKDAsMCwwLDAuMSk7XHJcbiAgYm9yZGVyLWxlZnQ6IDRweCBzb2xpZCAjNENBRjUwO1xyXG59XHJcblxyXG4ubm90aWZpY2F0aW9uLWl0ZW0udW5yZWFkIHtcclxuICBib3JkZXItbGVmdC1jb2xvcjogI2ZmNmI2YjtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOWY5O1xyXG59XHJcblxyXG4ubm90aWZpY2F0aW9uLWl0ZW0gaDQge1xyXG4gIGNvbG9yOiAjMmQ1MDE2O1xyXG4gIG1hcmdpbi1ib3R0b206IDAuNXJlbTtcclxufVxyXG5cclxuLm5vdGlmaWNhdGlvbi1pdGVtIHAge1xyXG4gIG1hcmdpbi1ib3R0b206IDAuNXJlbTtcclxuICBjb2xvcjogIzY2NjtcclxufVxyXG5cclxuLm5vdGlmaWNhdGlvbi1pdGVtIHNtYWxsIHtcclxuICBjb2xvcjogIzk5OTtcclxufVxyXG5cclxuLmFjdGlvbnMge1xyXG4gIG1hcmdpbi10b3A6IDFyZW07XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBnYXA6IDAuNXJlbTtcclxufVxyXG5cclxuLmFjdGlvbnMgYnV0dG9uIHtcclxuICBwYWRkaW5nOiA1cHggMTBweDtcclxuICBmb250LXNpemU6IDAuOHJlbTtcclxuICBtYXJnaW46IDA7XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"mappings":"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","names":["i0","NotificationsComponent","constructor","notificationService","plantService","route","id","title","description","notificationDate","Date","toISOString","isRead","user","undefined","plant","ngOnInit","loadNotifications","loadPlants","queryParams","subscribe","params","selectedPlantId","getUserNotifications","notifications","getUserPlants","plants","showAddForm","showForm","newNotification","createNotification","notificationData","notificationType","plantId","next","cancelForm","error","console","alert","message","markAsRead","deleteNotification","confirm","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\htismaila4\\Desktop\\Devops\\agrotrackwebapp\\src\\app\\components\\notifications\\notifications.component.html","C:\\Users\\htismaila4\\Desktop\\Devops\\agrotrackwebapp\\src\\app\\components\\notifications\\notifications.component.ts"],"sourcesContent":["<div class=\"notifications-container\">\n  <h2>Mes Notifications</h2>\n\n  <button (click)=\"showAddForm()\">Créer une notification</button>\n\n  <div *ngIf=\"showForm\" class=\"notification-form\">\n    <h3>Nouvelle notification</h3>\n    <form (ngSubmit)=\"createNotification()\">\n      <input [(ngModel)]=\"newNotification.title\" name=\"title\" placeholder=\"Titre\" required>\n      <textarea [(ngModel)]=\"newNotification.description\" name=\"description\" placeholder=\"Description\"></textarea>\n      <input type=\"datetime-local\" [(ngModel)]=\"newNotification.notificationDate\" name=\"notificationDate\" required>\n      <select [(ngModel)]=\"selectedPlantId\" name=\"selectedPlantId\">\n        <option value=\"0\">Aucune plante</option>\n        <option *ngFor=\"let plant of plants\" [value]=\"plant.id\">{{plant.name}}</option>\n      </select>\n      <button type=\"submit\">Créer</button>\n      <button type=\"button\" (click)=\"cancelForm()\">Annuler</button>\n    </form>\n  </div>\n\n  <div class=\"notifications-list\">\n    <div *ngFor=\"let notification of notifications\"\n         class=\"notification-item\"\n         [class.unread]=\"!notification.isRead\">\n      <h4>{{notification.title}}</h4>\n      <p>{{notification.description}}</p>\n      <small>Date: {{notification.notificationDate | date:'medium'}}</small>\n      <div class=\"actions\">\n        <button *ngIf=\"!notification.isRead\" (click)=\"markAsRead(notification.id)\">Marquer comme lu</button>\n        <button (click)=\"deleteNotification(notification.id)\">Supprimer</button>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { Notification } from '../../models/notification.model';\nimport { NotificationService } from '../../services/notification.service';\nimport { PlantService } from '../../services/plant.service';\n\n\n@Component({\n  selector: 'app-notifications',\n  templateUrl: './notifications.component.html',\n  styleUrls: ['./notifications.component.css']\n})\nexport class NotificationsComponent implements OnInit {\n  notifications: Notification[] = [];\n  plants: Plant[] = [];\n  showForm = false;\n  newNotification: Notification = {\n    id: 0,\n    title: '',\n    description: '',\n    notificationDate: new Date().toISOString(),\n    isRead: false,\n    user: undefined,\n    plant: undefined\n  };\n  selectedPlantId: number = 0;\n\n  constructor(\n    private notificationService: NotificationService,\n    private plantService: PlantService,\n    private route: ActivatedRoute\n  ) {}\n\n  ngOnInit() {\n    this.loadNotifications();\n    this.loadPlants();\n\n    // Récupère l'ID de plante depuis l'URL si présent\n    this.route.queryParams.subscribe(params => {\n      if (params['plantId']) {\n        this.selectedPlantId = +params['plantId'];\n      }\n    });\n  }\n\n  loadNotifications() {\n    this.notificationService.getUserNotifications().subscribe(notifications => {\n      this.notifications = notifications;\n    });\n  }\n\n  loadPlants() {\n    this.plantService.getUserPlants().subscribe(plants => {\n      this.plants = plants;\n    });\n  }\n\n  showAddForm() {\n    this.showForm = true;\n    this.newNotification = {\n      id: 0,\n      title: '',\n      description: '',\n      notificationDate: new Date().toISOString(),\n      isRead: false,\n      user: undefined,\n      plant: undefined\n    };\n  }\n\n  createNotification() {\n    const notificationData = {\n      title: this.newNotification.title,\n      description: this.newNotification.description,\n      notificationDate: this.newNotification.notificationDate,\n      notificationType: 'RAPPEL'\n    };\n\n    const plantId = this.selectedPlantId === 0 ? undefined : this.selectedPlantId;\n\n    this.notificationService.createNotification(notificationData, plantId)\n      .subscribe({\n        next: () => {\n          this.loadNotifications();\n          this.cancelForm();\n        },\n        error: (error) => {\n          console.error('Erreur création notification:', error);\n          alert('Erreur: ' + (error.error?.message || 'Création échouée'));\n        }\n      });\n  }\n\n  markAsRead(id: number) {\n    this.notificationService.markAsRead(id).subscribe(() => {\n      this.loadNotifications();\n    });\n  }\n\n  deleteNotification(id: number) {\n    if (confirm('Supprimer cette notification?')) {\n      this.notificationService.deleteNotification(id).subscribe(() => {\n        this.loadNotifications();\n      });\n    }\n  }\n\n  cancelForm() {\n    this.showForm = false;\n    this.selectedPlantId = 0;\n  }\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}